<!DOCTYPE html>
<meta charset=utf-8>
<title>Detekujeme podporu HTML5 - Dive Into HTML5</title>
<!--[if lt IE 9]><script src=j/html5.js></script><![endif]-->
<link rel=alternate type=application/atom+xml href=https://github.com/diveintomark/diveintohtml5/commits/master.atom>
<link rel=stylesheet href=screen.css>
<style>
body{counter-reset:h1 2}
</style>
<link rel=stylesheet media='only screen and (max-device-width: 480px)' href=mobile.css>
<link rel=prefetch href=index.html>
<p>You are here: <a href=index.html>Home</a> <span class=u>&#8227;</span> <a href=table-of-contents.html#detect>Dive Into <abbr>HTML5</abbr></a> <span class=u>&#8227;</span>
<h1><br>Detekujeme podporu <abbr>HTML5</abbr></h1>
<p id=toc>&nbsp;
<p class=a>&#x2767;
<h2 id=divingin>Jdeme na to</h2>

<p class=f><img src=i/aoc-m.png alt=M width=109 height=105>ohli byste se ptát: &#8222;Jak můžu používat <abbr>HTML5</abbr>, když ho starší prohlížeče nepodporují?&#8221; Ale byla by to zavádějící otázka. <abbr>HTML5</abbr> se skládá z řady částí. Nemůžete proto detekovat, zda prohlížeč &#8222;podporuje <abbr>HTML5</abbr>&#8221;, protože by to nedávalo žádný smysl. Ovšem <em>můžete</em> detekovat podporu jednotlivých částí (vlastností) HTML5, např. zda prohlížeč podporuje canvas, video nebo geolokaci.

<p class=a>&#x2767;

<h2 id=techniques>Techniky detekce</h2>

<p>Když prohlížeč vykresluje webovou stránku, vytvoří Document Object Model (<abbr><dfn>DOM</dfn></abbr>), což je kolekce objektů, které představují jednotlivé <abbr>HTML</abbr> prvky stránky. Každý prvek &mdash; každý <code>&lt;p></code>, každý <code>&lt;div></code>, každý <code>&lt;span></code> &mdash; je v <abbr>DOM</abbr>u zvláštním objektem. (Existujé také globální objekty, např. <code>window</code> a <code>document</code>, které se nevztahují k žádnému konkrétnímu prvku stránky.)

<p class=ss style="width:257px"><img src=i/openclipart.org_johnny_automatic_peeking_out_the_window.png width=257 height=436 alt="děvčátko, které se dívá z okna">

<p>Všechny objekty <abbr>DOM</abbr>u sdílí sadu společných vlastností, ovšem některé objekty mají některé vlastnosti navíc. V prohlížečích, které podporují vlastnosti <abbr>HTML5</abbr>, budou mít některé objekty unikátní vlastnosti. Rychlých pohledem na <abbr>DOM</abbr> tak zjistíme, které vlastnosti prohlížeč podporuje.

<p>Existují čtyři základní techniky detekující konkrétní vlastnost v tom kterém prohlížeči. Ukážeme si je od nejjednodušší po tu nejsložitější:

<ol>
<li>
<p>Ověřte, zda existuje jistá vlastnost globálního objektu (např. <code>window</code> nebo <code>navigator</code>).
<p>Příklad: <a href=#geolocation>test podpory geolokace</a>
<li>
<p>Vytvořte HTML prvek a ověřte, zda u něj existuje jistá vlastnost.
<p>Příklad: <a href=#canvas>text podpory canvasu</a>
<li>
<p>Vytvořte HTML prvek, ověřte, zda u něj existuje jistá metoda, zavolejte ji a zkontrolujte návratovou hodnotu.
<p>Příklad: <a href=#video-formats>test podporovaných formátů videa</a>
<li>
<p>Vytvořte HTML prvek, nastavte něj vlastnost na jistou hodnotu a pak zkontrolujte, zda si vlastnost tuto hodnotu uchovala.
<p>Příklad: <a href=#input-types>text podporovaných typů značky <code>&lt;input></code></a>
</ol>

<p class=a>&#x2767;

<h2 id=modernizr>Modernizr, knihovna pro detekci HTML5</h2>

<p><a href=http://www.modernizr.com/>Modernizr</a> je javascriptové open source knihonva (pod licencí <abbr>MIT</abbr>), která slouží k detekci řady vlastností <abbr>HTML5</abbr> <i class=baa>&amp;</i> <abbr>CSS3</abbr>. Měly byste vždy používat její nejnovější verzi. Pokud ji chcete použít, přidejte následující prvek <code>&lt;script></code> na začátek vaší webové stránky.

<pre style="float:left"><code>&lt;!DOCTYPE html>
&lt;html>
&lt;head>
  &lt;meta charset="utf-8">
  &lt;title>Dive Into HTML5&lt;/title>
  <mark>&lt;script src="modernizr.min.js">&lt;/script></mark>
&lt;/head>
&lt;body>
  ...
&lt;/body>
&lt;/html>
</code></pre>
<p class="legend right" style="margin-top:7em"><span class=arrow>&nbsp;&#x219c;</span> Vložte do &lt;head>

<p class=clear>Modernizr se spouští automaticky. Nemusíte proto volat žádnou metodu typu <code>modernizr_init()</code>. Jakmile se spustí, vytvoří globální objekt jmenující se <code>Modernizr</code>, který obsahuje sadu logických (Boolean) vlastností pro každou detekovanou vlastnost. Například, pokud váš prohlížeč podporuje <a href=canvas.html>canvas <abbr>API</abbr></a>, tak vlastnost <code>Modernizr.canvas</code> bude rovna <code>true</code>. Pokud váš prohlížeč canvas <abbr>API</abbr> nepodporuje, tak bude vlastnost <code>Modernizr.canvas</code> mít hodnotu <code>false</code>.

<pre><code>if (Modernizr.canvas) {
  // něco honem nakreslíme!
} else {
  // žádná podpora canvasu 8-(
}</code></pre>

<p class=a>&#x2767;

<h2 id=canvas>Canvas</h2>

<p class=ss style="width:300px"><img src=i/openclipart.org_johnny_automatic_fishing_boat.png width=300 height=203 alt="muž rybařící na loďce"><br><span id=live-canvas></span>

<p><abbr>HTML5</abbr> definuje <a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html>prvek &lt;canvas></a> jako &#8222;na rozlišení závislé plátno, které lze použít pro vykreslení grafů, herní grafiky nebo jiných obrázků <i>za běhu</i>.&#8221; Prvek <dfn>canvas</dfn> vytvoří na vaší stránce obdélník, do kterého můžete JavaScriptem nakreslit, cokoliv si budete přát. <abbr>HTML5</abbr> definuje sadu funkcí (&#8222;the canvas <abbr>API</abbr>&#8221;) pro kreslení tvarů, definování cest, tvorbu gradientů a používání transformací.

<p>Test podpory canvas <abbr>API</abbr> použivá <a href=#techniques>detekční techniku #2</a>. Pokud váš prohlížeč podporuje canvas <abbr>API</abbr>, pak objekt <abbr>DOM</abbr> reprezentující vytvořený prvek <code>&lt;canvas></code> bude obsahovat <a href=canvas.html#shapes>metodu <code>getContext()</code></a>. Pokud váš pohlížeč canvas <abbr>API</abbr> nepodporuje, tak objekt <abbr>DOM</abbr> reprezentující vytvořený prvek <code>&lt;canvas></code> bude mít pouze sadu běžných vlastností, ovšem žádnou z těch specifických pro canvas.

<pre><code>function supports_canvas() {
  return !!document.createElement('canvas').getContext;
}
</code></pre>

<p>Tato funkce nejprve vytvoří prázdný prvek <code>&lt;canvas></code>, který ovšem není přidán do vaší stránky, takže jej nikdy nikdo neuvidí. Je pouze vytovřený v paměti a plave si odnikud nikam jako loďka po líné řece.

<pre><code>return !!document.<mark>createElement('canvas')</mark>.getContext;</code></pre>

<p>Na vytvořeném prázdném prvku <code>&lt;canvas></code> otestujeme přítomnost metody <code>getContext()</code>. Tuto metodu najdeme pouze v prohlížečích podporujících canvas <abbr>API</abbr>.

<pre><code>return !!document.createElement('canvas').<mark>getContext</mark>;</code></pre>

<p>A konečně, použijeme fintu dvojí negace, abychom jako návratovou hodnotu funkce získali logickou hodnotu (<code>true</code> nebo <code>false</code>).

<pre><code>return <mark>!!</mark>document.createElement('canvas').getContext;</code></pre>

<p>Tato funkce ověří podporu velké části canvas <abbr>API</abbr>, což zahrnuje <a href=canvas.html#shapes>tvary</a>, <a href=canvas.html#paths>cesty</a>, <a href=canvas.html#gradients>gradienty <i class=baa>&amp;</i> vzory</a>. Nedokáže detekovat knihovny třetích stran jako je knihovna <a href=canvas.html#ie><code>explorercanvas</code></a> implementující canvas <abbr>API</abbr> do Microsoft Internet Exploreru.

<p>Funkci nemusíte psát sami, místo toho můžete použít <a href=#modernizr>Modernizr</a>, aby detekoval canvas <abbr>API</abbr> za vás.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> otestuj podporu canvasu
<pre><code>if (<mark>Modernizr.canvas</mark>) {
  // něco honem nakreslíme!
} else {
  // žádná podpora canvasu 8-(
}</code></pre>

<p>Nyní se podíváme na další test, který ověřuje podporu canvas text <abbr>API</abbr>.

<p class=a>&#x2767;

<h2 id=canvas-text>Text v canvasu</h2>

<p class=ss style="width:414px"><img src=i/openclipart.org_johnny_automatic_baseball_at_bat.png width=414 height=254 alt="baseballový hráč na pálce"><br><span id=live-canvas-text></span>

<p>I přestože váš prohlížeč podporuje <a href=#canvas>canvas <abbr>API</abbr></a>, nemusí ještě nutně podporovat <dfn>canvas text</dfn> <abbr>API</abbr>. Canvas <abbr>API</abbr> se totiž vyvíjelo a textové funkce byly přidány až později. Některé prohlížeče implementovaly canvas ještě před tím, než se objevilo text <abbr>API</abbr>.

<p>Test na canvas text <abbr>API</abbr> používá <a href=#techniques>detekční techniku #2</a>. Pokud váš prohlížeč podporuje canvas <abbr>API</abbr>, pak objekt <abbr>DOM</abbr> reprezentující vytvořený prvek <code>&lt;canvas></code> bude obsahovat <a href=canvas.html#shapes>metodu <code>getContext()</code></a>. Pokud váš pohlížeč canvas <abbr>API</abbr> nepodporuje, tak objekt <abbr>DOM</abbr> reprezentující vytvořený prvek <code>&lt;canvas></code> bude mít pouze sadu běžných vlastností, ovšem žádnou z těch specifických pro canvas.

<pre><code>function supports_canvas_text() {
  if (!supports_canvas()) { return false; }
  var dummy_canvas = document.createElement('canvas');
  var context = dummy_canvas.getContext('2d');
  return typeof context.fillText == 'function';
}</code></pre>

<p>Tato funkce nejdřív <a href=#canvas>otestuje základní podporu canvasu</a> pomocí funkce <code>supports_canvas()</code>, kterou jste viděli v předchozí sekci. Pokud váš prohlížeč nepodporuje canvas <abbr>API</abbr>, pak zcela jistě nebude podporovat ani canvas text <abbr>API</abbr>.

<pre><code>if (<mark>!supports_canvas()</mark>) { return false; }</code></pre>

<p>Dále vytvoříme prázdný prvek <code>&lt;canvas></code> a získáme jeho kreslicí kontext. To musí fungovat, protože funkce <code>supports_canvas()</code> už otestovala existenci metody <code>getContext()</code> na objektech canvasu.

<pre><code>  var dummy_canvas = document.createElement('canvas');
  var context = <mark>dummy_canvas.getContext('2d')</mark>;</code></pre>

<p>Nakonec otestujeme, zda kreslicí kontext obsahuje funkci <code>fillText()</code>. Pokud ano, tak prohlížeč podporuje canvas text <abbr>API</abbr>. Hurá!

<pre><code>  return <mark>typeof context.fillText == 'function'</mark>;</code></pre>

<p>Funkci nemusíte psát sami, místo toho můžete použít <a href=#modernizr>Modernizr</a>, aby detekoval canvas text <abbr>API</abbr> za vás.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> check for canvas text support
<pre><code>if (<mark>Modernizr.canvastext</mark>) {
  // honem něco napíšeme!
} else {
  // žádná podpora pro canvas text 8-(
}</code></pre>

<p class=a>&#x2767;

<h2 id=video>Video</h2>

<p><abbr>HTML5</abbr> definuje nový prvek <code>&lt;video></code> sloužící k vkládání videa do vašich webových stránek. Dříve bylo nemožné vložit na stránku video bez použití pluginů od třetích stran jako Apple QuickTime&reg; nebo Adobe Flash&reg;.

<p class=ss style="width:224px"><img src=i/openclipart.org_johnny_automatic_at_the_theater.png alt="diváci v divadle" width=224 height=334><br><span id=live-video></span>

<p>Prvek <code>&lt;video></code> byl navržen tak, aby byl použitelný bez jakéhokoliv detekčního skriptu. Můžete uvést několik video souborů a prohlížeče, které <abbr>HTML5</abbr> video podorují, si z nich vyberou, podle toho, jaké formáty podporují.

(Viz &#8222;A gentle introduction to video encoding&#8221; <a href=http://diveintomark.org/archives/2008/12/18/give-part-1-container-formats>part 1: container formats</a> a <a href=http://diveintomark.org/archives/2008/12/19/give-part-2-lossy-video-codecs>part 2: lossy video codecs</a>, kde se dozvíte víc o rozličných formátech videa.)

<p>Prohlížeče, které nepodorují <abbr>HTML5</abbr> video, budou prvek <code>&lt;video></code> zcela ignorovat. Toho ovšem můžete využít a nabídnout jim místotoho k přehrání video pomocí pluginu. Kroc Camen sestavil řešení nazvané <a href=http://camendesign.com/code/video_for_everybody>Video for Everybody! (Video pro každého)</a>, které používá <abbr>HTML5</abbr> video tam, kde je to možné, a ve starších prohlížečích využije QuickTime nebo Flash. Krocovo řešení navíc nepoužívá žádný JavaScript a funguje teoreticky ve všech prohlížečích včetně mobilních.

<p>Pokud chcete s videem dělat víc, než jen ho umístit na stránku a přehrát, musíte už použít JavaScript. Test podpory videa využívá <a href=#techniques>detekční techniku #2</a>. Pokud váš prohlížeč podporuje <abbr>HTML5</abbr> video, tak objekt <abbr>DOM</abbr> reprezentující vytvořený prvek <code>&lt;video></code> bude obsahovat metodu <code>canPlayType()</code>. Pokud váš prohlížeč nepodporuje <abbr>HTML5</abbr> video, tak objekt <abbr>DOM</abbr> reprezentující vytvořený prvek <code>&lt;video></code> bude mít pouze sadu vlastností běžných pro všechny prvky HTML. Podporu videa můžete otestovat touto funkcí:

<pre><code>function supports_video() {
  return !!document.createElement('video').canPlayType;
}</code></pre>

<p>Fukci nemusíte psát sami, místo toho můžete použít <a href=#modernizr>Modernizr</a>, aby detekoval podporu <abbr>HTML5</abbr> videa za vás.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> ověř podporu <abbr>HTML5</abbr> videa
<pre><code>if (<mark>Modernizr.video</mark>) {
  // pusťme si nějaké video!
} else {
  // nativní podpora videa není dostupná 8-(
  // mohli bychom zkusit otestovat podporu QuickTime nebo Flashe
}</code></pre>

<p>V <a href=video.html>kapitole o videu</a> popíšu další řešení, které používá tyto detekční techniky pro konverzi elementů <code>&lt;video></code> na kód pro videopřehrávače postavené na Flashi, což využijí prohlížeče, které <abbr>HTML5</abbr> video nepodorují.

<p>Nyní se podíváme na test pro detekci formátů videa, které dokáže prohlížeč přehrát.

<p class=a>&#x2767;

<h2 id=video-formats>Formáty videa</h2>

<p>Formáty videa bychom mohli přirovnat k psaným jazykům. Noviny v češtině mohou sdělovat stejnou informaci jako španělské noviny, ovšem pokud umít číst pouze česky, tak vám k něčemu budou pouze ty první. Aby prohlížeč mohl přehrát video, musí rozumět &#8222;jazyku&#8221;, kterým je video napsáno.

<p class=ss style="float:left;margin:0 1.75em 1.75em 0;width:250px"><img src=i/openclipart.org_johnny_automatic_man_reading_newspaper.png alt="muž čtoučí noviny" width=250 height=261><br><span id=live-video-formats></span>

<p>Takový &#8222;jazyk&#8221;, ve kterém je video zapsáno, se nazývá &#8220;kodek&#8221; &mdash; jedná se o algoritmus, podle kterého se video zakóduje do řady bitů. Existuje hromada kodeků, jenže který s nich máme použít? Skutečnost je smutná, prohlížeče se nedokázaly dohodnut na používání jednoho stejného kodeku. Ovšem, alespoň celou tu hromadu kodeků změnšily na pouhé dva. První kodek je placený (platí se licenční poplatky za patenty), ale funguje v <a href=http://www.apple.com/safari/>Safari</a> a na iPhone. (Funguje také ve Flashi, pokud použijete řešení typu <a href=http://camendesign.com/code/video_for_everybody>Video for Everybody!</a>.) Druhý kodek je zdarma a funguje v open source prohlžečích jako je <a href=http://code.google.com/chromium/>Chromium</a> a <a href=http://www.getfirefox.com/>Mozilla Firefox</a>.

<p>Test podpory formátů videa používá <a href=#techniques>detekční techniku #3</a>. Pokud váš prohlížeč podporuje <abbr>HTML5</abbr> video, tak objekt <abbr>DOM</abbr> reprezentující vytvořený prvek <code>&lt;video></code> bude obsahovat metodu <code>canPlayType()</code>. Tato metoda vám řekne, zda prohlížeč podporuje konkrétní formát videa.

<p>Tato funkce otestuje patenty zatížený formát, který funguje na Macích a iPhonech.

<pre><code>function supports_h264_baseline_video() {
  if (!supports_video()) { return false; }
  var v = document.createElement("video");
  return v.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');
}</code></pre>

<p>Funkce začíná <a href=#video>otestováním podporu <abbr>HTML5</abbr> videa</a> pomocí funkce <code>supports_video()</code>, kterou jste poznali v předchozí sekci. Pokud váš prohlížeč nepodporuje <abbr>HTML5</abbr> video, nebude také podporovat žádný formát videa.

<pre><code>  if (<mark>!supports_video()</mark>) { return false; }</code></pre>

<p>Po té funce vytvoří prázný prvek <code>&lt;video></code> (ovšem nevloží ho do stránky, takže nebude viditelný) a zavolá metodu <code>canPlayType()</code>. Ta musí existovat, protože to již ověřila funkce <code>supports_video()</code>.

<pre><code>  var <mark>v</mark> = document.createElement("video");</code></pre>

<p>&#8222;Formát videa&#8221; je ve skutečností kombinací několika věcí. Technicky řečeno se prohlížeče ptáte, zda dokáže přehrát video v H.264 a zvuk v AAC LC, obojí vložené v kontejneru. (Co to všechno znamená si vysvětlíme v <a href=video.html>kapitole o videu</a>. Může vás také zajímat článek <a href=http://diveintomark.org/tag/give>A gentle introduction to video encoding</a>.)

<pre><code>  return v.canPlayType('<mark>video/mp4; codecs="avc1.42E01E, mp4a.40.2"</mark>');</code></pre>

<p>Funkce <code>canPlayType()</code> nevrací prosté <code>true</code> nebo <code>false</code>. Podle toho, o jak komplexní formáty videa se jedná, vrací funkce řetezce:

<ul>
<li><code>"probably"</code> pokud je prohlížeč opravdu přesvědčen, že může tento formát přehrát
<li><code>"maybe"</code> pokud si prohlížeč myslí, že možná může tento formát přehrát
<li><code>""</code> (prázdný řetězec) pokud si je prohlížeč jistý, že tento formát přehrát nemůže
</ul>

<p>Následující druhá funkce otestuje podporu otevřeného formátu videa, který podporuje Mozilla Firefox a další open source prohlížeče. Celý proces je stejný, s jediným rozdílem - v řetězci, který předáme funkci <code>canPlayType()</code>. Technicky řečeno se prohlížeče ptáte, zda dokáže přehrát video v Theora a zkub v Vorbis, to vše vložené do Ogg kontejneru.

<pre><code>function supports_ogg_theora_video() {
  if (!supports_video()) { return false; }
  var v = document.createElement("video");
  return v.canPlayType(<mark>'video/ogg; codecs="theora, vorbis"'</mark>);
}</code></pre>

<p>A konečně, <a href=http://www.webmproject.org/>WebM</a> je nový open source (a patenty nezatížený) kodek videa, který bude obsažen v dalších verzích hlavních prohlížečů včetně Chrome, <a href=http://nightly.mozilla.org/webm/>Firefoxu</a> a <a href=http://labs.opera.com/news/2010/05/19/>Opery</a>. Pro detekci podpory formátu videa WebM použijeme stejnou techniku.

<pre><code>function supports_webm_video() {
  if (!supports_video()) { return false; }
  var v = document.createElement("video");
  return v.canPlayType(<mark>'video/webm; codecs="vp8, vorbis"'</mark>);
}</code></pre>

<p>Funkce nemusíte psát sami, místo toho můžete použít <a href=#modernizr>Modernizr</a> (1.5 nebo novější), aby detekoval jednotlivé formáty <abbr>HTML5</abbr> videa.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> otestuje podporované formáty <abbr>HTML5</abbr> videa
<pre><code>if (Modernizr.video) {
  // pusťme si teď nějaké video! ale jaké?
  if (<mark>Modernizr.video.webm</mark>) {
    // zkusme WebM
  } else if (<mark>Modernizr.video.ogg</mark>) {
    // zkusme Ogg Theora + Vorbis v Ogg kontejneru
  } else if (<mark>Modernizr.video.h264</mark>){
    // zkusme H.264 video + AAC audio v MP4 kontejneru
  }
}</code></pre>

<p class=a>&#x2767;

<h2 id=storage>Local Storage</h2>

<p class=ss style="width:135px"><img src=i/openclipart.org_johnny_automatic_half_stack_of_horizontal_sections.png alt="kabinet plný zásuvek rozličných rozměrů" width=135 height=341><br><span id=live-storage></span>

<p><a href=http://dev.w3.org/html5/webstorage/><abbr>HTML5</abbr> úložiště</a> nabízí způsob, jakým mohou webové stránky uložit informace na váš počítač a pozdeji je znovu načíst. Jedná se podobný koncept jako byly cookies, ovšem je navržený pro větší množství informací. Cookies mají omezenou velikost a váš prohlížeč je zasílá zpět na server kdykoliv požádá o novou stránku (což zabírá čas i datové pásmo). <abbr>HTML5</abbr> úložiště zůstává na vašem počítači, webové stránky k němu mohou přistoupit pomocí JavaScriptu.

<div class="pf clear">
<h4>Zeptejte se profesora Značky</h4>
<div class=inner>
<blockquote class=note>
<p><span>&#x261E;</span>OT: Je lokální úložiště skutečně součástí <abbr>HTML5</abbr>? Proč se nachází ve zvláštní specifikaci?<br>
OD: Stručně řečeno ano, lokální úložitě je součástí <abbr>HTML5</abbr>. Trochu delší odpověd je, že lokální úložiště bylo součástí hlavní specifikace <abbr>HTML5</abbr>, ale bylo odděleno do zvláštní specifikace, protože některým členům pracovní skupiny pro <abbr>HTML5</abbr> se nelíbilo, že je specifikace <abbr>HTML5</abbr> příliš dlouhá. Pokud vám to zní jako rozkrájení koláče na menší kousky ve snaze snížit počet jeho kalorií, pak ano - vítejte v šíleném světě standardů.
</blockquote>
</div>
</div>

<p>Test podpory <abbr>HTML5</abbr> úložiště využívá <a href=#techniques>detekční techniku #1</a>. Pokud váš prohlížeč podporuje <abbr>HTML5</abbr> úložiště, pak bude na globálním objektu <code>window</code> existovat vlastnost <code>localStorage</code>. Pokud váš prohlížeč nepodporuje <abbr>HTML5</abbr> úložiště, pak bude vlastnost <code>localStorage</code> nedefinovaná. Nepříjemná chyba ve starších verzích Firefoxu způsobuje, že tento test vyvolá výjimky, pokud je vypnutá podpora cookies, proto je nutné celý test vložit do bloku <code>try..catch</code>.

<pre><code>function supports_local_storage() {
  try {
    return 'localStorage' in window && window['localStorage'] !== null;
  } catch(e){
    return false;
  }
}</code></pre>

<p>Funkci nemusíte psát sami, místo toho můžete použít <a href=#modernizr>Modernizr</a> (1.1 nebo novější), aby detekoval podporu lokálního úložiště <abbr>HTML5</abbr>.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> otestuj podporu lokálního úložiště <abbr>HTML5</abbr>
<pre><code>if (<mark>Modernizr.localstorage</mark>) {
  // window.localStorage je dostupné!
} else {
  // nativní podpora pro lokální úložiště neexistuje 8-(
  // mohli bychom ještě zkusit Gears nebo jiné řešení od třetích stran
}</code></pre>

<p>Nezapomeňte, že JavaScript je case-sensitive. Vlastnost Modernizru se jmenuje <code>localstorage</code> (všechna písmena malá), ovšem vlastnost objektu <abbr>DOM</abbr> se jmenuje <code>window.localStorage</code>.

<div class="pf clear">
<h4>Zeptejte se profefora Značky</h4>
<div class=inner>
<blockquote class=note>
<p><span>&#x261E;</span>OT: Jak je moje <abbr>HTML5</abbr> úložiště zabezpečené? Může ho kdokoliv přečíst?<br>
OD: Kdokoliv, kdo má fyzický přístup k počítači by se mohl na data vašeho <abbr>HTML5</abbr> úložiště podívat (nebo je dokonce změnit). V prohlížeči může každá webová stránka číst a upravovat svá vlastní data, ovšem nemůže přistupovat k datům uloženým z jiných webů. Říká se tomu <a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#origin-0>same-origin restriction (omezení dle původu)</a>.
</blockquote>
</div>
</div>

<p class=a>&#x2767;

<h2 id=workers>Web Workers</h2>

<p class=ss style="margin:1.75em"><span id=live-web-workers></span>

<p><a href=http://www.whatwg.org/specs/web-workers/current-work/>Web Workers</a> nabízí standardizovanou cestu, jakou mohou prohlížeče spouštět javascriptový kód na pozadí. S pomocé web workers můžete spustit několik &#8222;vláken&#8221; a ty pak mohou běžet více méně ve stejném čase. (Stačí, když si představíte, že váš počítač dokáže součastně spustit několik aplikací, je to skoro to samé.) Tato &#8222;vlákna na pozadí&#8221; mohou provádět složité matematické výpočty a sítové požadavky nebo přistupovak k <a href=#local-storage>local storage</a> zatímco hlavní webová stránka reaguje na akce uživatele, ať už se jedná o skrolování, klikání nebo psaní.

<p>Test podpory web workers využívá <a href=#techniques>detekční techniku #1</a>. Pokud váš prohlížeč podporuje Web Worker <abbr>API</abbr>, bude u globálního objektu <code>window</code> existovat vlastnost <code>Worker</code>. Pokud váš prohlížeč nepodporuje Web Worker <abbr>API</abbr>, pak bude vlastnost <code>Worker</code> nedefinovaná.

<pre><code>function supports_web_workers() {
  return !!window.Worker;
}</code></pre>

<p>Funkci nemusíte psát sami, místo toho můžete použít <a href=#modernizr>Modernizr</a> (1.1 nebo novější), aby detekoval podporu web workers.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> otestuj podporu web workers
<pre><code>if (<mark>Modernizr.webworkers</mark>) {
  // window.Worker je dostupné!
} else {
  // chybí nativní podpora pro web workers 8-(
  // můžeme vyzkoušet Gears nebo jiný plugin třetích stran
}</code></pre>

<p>Nezapomeňte, že JavaScript je case-sensitive. Vlastnost Modernizru se jmenuje <code>webworkers</code> (všechna písmena malá), ovšem vlastnost objektu <abbr>DOM</abbr> se jmenuje <code>window.Worker</code>.

<p class=a>&#x2767;

<h2 id=offline>Offline webové aplikace</h2>

<p class=ss style="width:257px"><img src=i/openclipart.org_johnny_automatic_cabin_along_stream.png alt="chata v lesích" width=257 height=242><br><span id=live-offline></span>

<p>Je snadné číst webové stránky, když jste offline: stačí se připojit k internetu, načíst webovou stránku, odpojit se od internetu, odjet na opuštěnou chatu a tam si vklidu stránku přečíst. (Abyste ušetřili čas, klidně přeskočte ten krok s chatou.) Ovšem, co webové aplikace jako jsou <a href=http://mail.google.com/>Gmail</a> nebo <a href=http://docs.google.com/>Dokumenty Google</a>? S <abbr>HTML5</abbr> může kdokoliv (nejen Google!) vytvářet aplikace, které fungují offline.

<p><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html#offline>Offline webové aplikace</a> začínají jako online webové aplikace. Když prvně navštívíte aplikaci podporující režim offline, webový server řekne prohlížeči, které soubory bude potřebovat, aby mohl fungovat offline. Může se jednat o jakékoliv soubory &mdash; <abbr>HTML</abbr>, JavaScript, obrázky, dokonce <a href=#video>videa</a>. Jakmile váš prohlížeč stáhne všechny potřebné soubory, můžete stránku znovu navštívit, i když nejste připojeni k internetu. Váš prohlížeč si všimne, že jste právě offline a použije soubory, které si předtím stáhnul. Jakmile se opět připojíte online, všechny změny, které jste provedli, se nahrají na vzdálená webový server.

<p>Test na podporu pro offline používá <a href=#techniques>detekční techniku #1</a>. Pokud váš prohlížeč podporuje offline webové aplikace, bude u globálního objektu <code>window</code> existovat vlastnot <code>applicationCache</code>. Pokud váš prohlížeč offline webové aplikace nepodporuje, pak bude vlastnost <code>applicationCache</code> nedefinovaná. Podporu pro offline webové aplikace můžete otestovat následující funkcí:

<pre><code>function supports_offline() {
  return !!window.applicationCache;
}</code></pre>

<p>Funkci nemusíte psát sami, místo toho můžete použít <a href=#modernizr>Modernizr</a> (1.1 nebo novější), aby podporu detekoval.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> otestuj podporu pro offline webové aplikace
<pre><code>if (<mark>Modernizr.applicationcache</mark>) {
  // window.applicationCache je dostupné!
} else {
  // native podpora offline aplikací není dostupná 8-(
  // můžeme vyzkoušet Gears nebo jiný plugin třetích stran
}</code></pre>

<p>Nezapomeňte, že JavaScript je case-sensitive. Vlastnost Modernizru se jmenuje  <code>applicationcache</code> (všechna písmena malá), ovšem vlastnost objektu <abbr>DOM</abbr> se jmenuje <code>window.applicationCache</code>.

<p class=a>&#x2767;

<h2 id=geolocation>Geolokace</h2>

<p>Pomocí geolokace lze jistit, kde na světě se právě teď nacházíte a (volitelně) oznámit tuto informaci lidem, kterým důvěřujete. Existuje několik způsobů, jak je možné zjistit, kde se právě nacházíte &mdash; vaše <abbr>IP</abbr> adresa, vaše bezdrátové připojení k síti, přes které buňky telefonní sítě jste připojeni nebo vyhrazený <abbr>GPS</abbr> hardware, který spočítá vaši zeměpisnou šířku a délku na základě informací zaslaných satelity z oblohy.

<p style="margin:0 auto;width:194px" id=geo-wrapper><img src=i/openclipart.org_johnny_automatic_globe_man.png alt="muž s globusem místo hlavy" width=194 height=317><br><span id=live-geolocation></span>

<div class="pf clear">
<h4>Zeptejte se profesora Značky</h4>
<div class=inner>
<blockquote class=note>
<p><span>&#x261E;</span>OT: Je geolokace součástí <abbr>HTML5</abbr>? Proč o ní hovoříte?<br>
OD: Podpora pro geolokaci je do prohlížečů přidávána právě teď, ve stejnou dobu, kdy se do prohlížečů přidávají nové vlastnosti <abbr>HTML5</abbr>. Přesně řečeno, geolokace je standardizována <a href=http://www.w3.org/2008/geolocation/>pracovní skupinout pro geolokaci</a>, která je nezávislá na pracovní skupině pro <abbr>HTML5</abbr>. Ovšem já do této knížky geolokaci stejně zahrnu, protože se jedná o součást evoluce webu, ke které dochází právě teď.
</blockquote>
</div>
</div>

<p>Test podpory geolokace používá <a href=#techniques>detekční techniku #1</a>. Pokud váš prohlížeč podporuje geolocation <abbr>API</abbr>, bude u globálního objektu <code>navigator</code> existovat vlastnost <code>geolocation</code>. Pokud váš prohlížeč geolocation <abbr>API</abbr> nepodporuje, tak vlastnost <code>geolocation</code> bude nedefinovaná. Podívejme se, jak otestovat podporu geolokace:

<pre><code>function supports_geolocation() {
  return !!navigator.geolocation;
}</code></pre>

<p>Funkci nemusíte psát sami, místo toho můžete použít <a href=#modernizr>Modernizr</a>, který podporu geolocation <abbr>API</abbr> otestuje.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> otestuj podporu geolokace
<pre><code>if (<mark>Modernizr.geolocation</mark>) {
  // tak a teď se podíváme, kde právě jsi!
} else {
  // nativní podpora pro geolokace není dostupná 8-(
  // můžeme vyzkoušet Gears nebo jiný plugin třetích stran
}</code></pre>

<p>Pokud váš prohlížeč geolocation <abbr>API</abbr> nativně nepodporuje, stále ještě zbývá naděje. <a href=http://tools.google.com/gears/>Gears</a> je open source plugin od Googlu, který funguje na Windows, Macu, Linuxu, Windows Mobile a Androidu. Nabízí některé vlastnosti starším prohlížečům, které nepodporují novinky zmiňované v této kapitole. Jednou z vlastností, které Gears nabízí, je geolocation <abbr>API</abbr>. Není zcela stejné jako <code>navigator.geolocation</code> <abbr>API</abbr>, ale slouží ke stejnému účelu.

<p>Existují také geolocation <abbr>API</abbr> specifiká pro jednotlivá zařízení, ta najdeme na starších mobilních platformách včetně <a href="http://www.tonybunce.com/2008/05/08/Blackberry-Browser-Amp-GPS.aspx">BlackBerry</a>, <a href="http://www.forum.nokia.com/infocenter/index.jsp?topic=/Web_Developers_Library/GUID-4DDE31C7-EC0D-4EEC-BC3A-A0B0351154F8.html">Nokia</a>, <a href="http://developer.palm.com/index.php?option=com_content&amp;view=article&amp;id=1673#GPS-getCurrentPosition">Palm</a>, a <a href=http://bondi.omtp.org/1.0/apis/geolocation.html><abbr title="Open Mobile Terminal Platform">OMTP</abbr> BONDI</a>.

<p><a href=geolocation.html>Kapitola o geolokaci</a> vás zasvětí do detailů toho, jak můžete tato odlišná <abbr>API</abbr> používat.

<p class=a>&#x2767;

<h2 id=input-types>Typy značky input</h2>

<p class=ss style="width:261px"><img src=i/openclipart.org_johnny_automatic_typewriter.png alt="psací stroj" width=261 height=228><br><span id=live-input-types></span>

<p>O webových formulářích jste již určitě slyšeli, že? Vytvoříte <code>&lt;form></code>, přidáte několik prvků <code>&lt;input type="text"></code>, možná i <code>&lt;input type="password"></code> a všechno ukončíte tlačítkem <code>&lt;input type="submit"></code>.

<p>Jenže to toho nevíte stěží polovinu. <abbr>HTML5</abbr> přidává přec tucet nových druhů značky input, které můžete použít ve vašich formulářích.

<ol>
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#text-state-and-search-state><code>&lt;input type="search"></code></a> pro vyhledávací boxy
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/number-state.html#number-state><code>&lt;input type="number"></code></a> pro zadávání čísel
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/number-state.html#range-state><code>&lt;input type="range"></code></a> pro posuvníky
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/number-state.html#color-state><code>&lt;input type="color"></code></a> pro výběr barev
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#telephone-state><code>&lt;input type="tel"></code></a> pro telefonní čísla
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#url-state><code>&lt;input type="url"></code></a> pro webové adresy
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#e-mail-state><code>&lt;input type="email"></code></a> pro e-mailové adresy
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#date-state><code>&lt;input type="date"></code></a> pro výběr data v kalendáři
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#month-state><code>&lt;input type="month"></code></a> pro výběr měsíce
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#week-state><code>&lt;input type="week"></code></a> pro výběr týdne
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#time-state><code>&lt;input type="time"></code></a> pro výběr času
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#date-and-time-state><code>&lt;input type="datetime"></code></a> pro výběr přesného absolutního údaje datum + čas
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#local-date-and-time-state><code>&lt;input type="datetime-local"></code></a> pro lokální datum a čas
</ol>

<p>Test podpory nových <abbr>HTML5</abbr> typů značky input používá <a href=#techniques>detekční techniku #4</a>. Napřed vytvoříme prádný prvek <code>&lt;input></code> v paměti. Výchozím tydem pro všechny prvky <code>&lt;input></code> je <code>"text"</code>. To se ukáže jako velmi důležité.

<pre><code>  var i = document.createElement("input");</code></pre>

<p>Po té nastavíme atribut <code>type</code> námi vytvořeného prvku <code>&lt;input></code> na typ, který chceme detekovat.

<pre><code>  i.setAttribute("type", "color");</code></pre>

<p>Pokud prohlížeč daný typ podporuje, pak bude vlastnost <code>type</code> mít hodnotu, jakou jsme jí zadali. Pokud prohlížeč daný typ nepodporuje, bude námi zadanou hodnotu ignorovat a vlastnost <code>type</code> bude stále <code>"text"</code>.

<pre><code>  return i.type !== "text";</code></pre>

<p>Než abyste psali všech 13 funkcí sami, můžete použít <a href=#modernizr>Modernizr</a>, který detekci všech nových typů definovaných v <abbr>HTML5</abbr> provede za vás. Modernizr používá jeden jediný prvek <code>&lt;input></code>, aby efektivně otestoval podporu všech 13 typů. Následně vytvoří asociativní pole nazvané <code>Modernizr.inputtypes</code>, které obsahuje 13 klíčů (názvy jednotlivých <code>typů</code>) a 13 logických hodnot (<code>true</code> pokud typ prohlížeč podporuje, <code>false</code> když ne).

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> otestování podpory pro výběr data
<pre><code>if (<mark>!Modernizr.inputtypes.date</mark>) {
  // chybí native podpora pro &lt;input type="date"> 8-(
  // můžete sami vytvořit pomocí <a href=http://docs.dojocampus.org/dojox/widget/Calendar>Dojo</a> nebo <a href=http://jqueryui.com/demos/datepicker/>jQueryUI</a>
}</code></pre>

<p class=a>&#x2767;

<h2 id=input-placeholder>Placeholder (textová nápověda)</h2>

<form style="float:right;margin:1.75em"><input placeholder="Váš prohlížeč podporuje placeholder" size=38></form>

<p>Vedle <a href=#input-types>nových typů značky input</a> přidává <abbr>HTML5</abbr> do formulářů několik menších vylepšení. Jedním z nich je možnost nastavit <a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/common-input-element-attributes.html#the-placeholder-attribute>vlastnost placeholder pro pole input</a>. Tzv. placeholder slouží jako nápověda, jedná se o text, který se zobrazí uvnitř pole input v případě, že je pole prázdné a nemá fokus. Jakmile na pole kliknete (nebo se na ně přemístíte tabulátorem) placeholder zmizí. <a href=forms.html#placeholder>Kapitola o webových formulářích</a> obsahuje screenshoty, pokud si to nedokážete sami představit.

<p>Test podpory placeholderu využívá <a href=#techniques>detekční techniku #2</a>. Pokud váš prohlížeč podporuje placeholder v polích input, pak bude mít objekt <abbr>DOM</abbr> reprezentující vytvořený prvek <code>&lt;input></code> vlastnost <code>placeholder</code> (a to i v případě, že jste v <abbr>HTML</abbr> žádný atribut <code>placeholder</code> neuvedli). Pokud váš prohlížeč placeholder nepodporuje, tak objekt <abbr>DOM</abbr> reprezentující prvek <code>&lt;input></code> nebude mít vlastnost <code>placeholder</code>.

<pre><code>function supports_input_placeholder() {
  var i = document.createElement('input');
  return 'placeholder' in i;
}</code></pre>

<p>Funkci nemusíte psát sami, místo toho můžete použít <a href=#modernizr>Modernizr</a> (1.1 nebo novější), aby detekoval podoru placeholderu.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> otestuj podporu placeholderu
<pre><code>if (<mark>Modernizr.input.placeholder</mark>) {
  // váš placeholder by měl být už viditelný!
} else {
  // žádná podpora pro placeholder 8-(
  // spusťme fall back pomocí JavaScriptu
}</code></pre>

<p class=a>&#x2767;

<h2 id=input-autofocus>Autofocus formulářů</h2>

<p class=ss style="width:188px"><img src=i/openclipart.org_johnny_automatic_angry_guy.png alt="rozčilený chlap se zvednutýma rukama" width=188 height=262><br><span id="live-input-autofocus"></span>

<p>Web sites can use JavaScript to focus the first input field of a web form automatically. For example, the home page of <a href=http://www.google.com/>Google.com</a> will autofocus the input box so you can type your search keywords without having to position the cursor in the search box. While this is convenient for most people, it can be annoying for power users or people with special needs. If you press the space bar expecting to scroll the page, the page will not scroll because the focus is already in a form input field. (It types a space in the field instead of scrolling.) If you focus a different input field while the page is still loading, the site&#8217;s autofocus script may &#8220;helpfully&#8221; move the focus back to the original input field upon completion, disrupting your flow and causing you to type in the wrong place.

<p>Because the autofocusing is done with JavaScript, it can be tricky to handle all of these edge cases, and there is little recourse for people who don&#8217;t want a web page to &#8220;steal&#8221; the focus.

<p>To solve this problem, <abbr>HTML5</abbr> introduces <a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#autofocusing-a-form-control>an <code>autofocus</code> attribute on all web form controls</a>. The <code>autofocus</code> attribute does exactly what it says on the tin: it moves the focus to a particular input field. But because it&#8217;s just markup instead of a script, the behavior will be consistent across all web sites. Also, browser vendors (or extension authors) can offer users a way to disable the autofocusing behavior.

<p>Checking for autofocus support uses <a href=#techniques>detection technique #2</a>. If your browser supports autofocusing web form controls, the <abbr>DOM</abbr> object it creates to represent an <code>&lt;input></code> element will have an <code>autofocus</code> property (even if you don&#8217;t include the <code>autofocus</code> attribute in your <abbr>HTML</abbr>). If your browser doesn&#8217;t support autofocusing web form controls, the <abbr>DOM</abbr> object it creates for an <code>&lt;input></code> element will not have an <code>autofocus</code> property. You can detect autofocus support with this function:

<pre><code>function supports_input_autofocus() {
  var i = document.createElement('input');
  return 'autofocus' in i;
}</code></pre>

<p>Instead of writing this function yourself, you can use <a href=#modernizr>Modernizr</a> (1.1 or later) to detect support for autofocused form fields.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> check for autofocus support
<pre><code>if (<mark>Modernizr.input.autofocus</mark>) {
  // autofocus works!
} else {
  // no autofocus support :(
  // fall back to a scripted solution
}</code></pre>

<p class=a>&#x2767;

<h2 id=microdata>Microdata</h2>

<p class=ss style="width:305px"><img src=i/openclipart.org_johnny_automatic_divider_cards.png alt="alphabetized folders" width=305 height=224><br><span id="live-microdata-api"></span>

<p><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/links.html#microdata>Microdata</a> is a standardized way to provide additional semantics in your web pages. For example, you can use microdata to declare that a photograph is available under a specific Creative Commons license. As you&#8217;ll see in <a href=extensibility.html>the distributed extensibility chapter</a>, you can use microdata to mark up an &#8220;About Me&#8221; page. Browsers, browser extensions, and search engines can convert your <abbr>HTML5</abbr> microdata markup into a <a href=http://en.wikipedia.org/wiki/VCard>vCard</a>, a standard format for sharing contact information. You can also define your own microdata vocabularies.

<p>The <abbr>HTML5</abbr> microdata standard includes both <abbr>HTML</abbr> markup (primarily for search engines) and a set of <abbr>DOM</abbr> functions (primarily for browsers). There&#8217;s no harm in including microdata markup in your web pages. It&#8217;s nothing more than a few well-placed attributes, and search engines that don&#8217;t understand the microdata attributes will just ignore them. But if you need to access or manipulate microdata through the <abbr>DOM</abbr>, you&#8217;ll need to check whether the browser supports the microdata <abbr>DOM</abbr> <abbr>API</abbr>.

<p>Checking for <abbr>HTML5</abbr> microdata <abbr>API</abbr> support uses <a href=#techniques>detection technique #1</a>. If your browser supports the <abbr>HTML5</abbr> microdata <abbr>API</abbr>, there will be a <code>getItems()</code> function on the global <code>document</code> object. If your browser doesn&#8217;t support microdata, the <code>getItems()</code> function will be undefined.

<pre><code>function supports_microdata_api() {
  return !!document.getItems;
}</code></pre>

<p>Modernizr does not yet support checking for the microdata <abbr>API</abbr>, so you&#8217;ll need to use the function like the one listed above.

<p class=a>&#x2767;

<h2 id=history>History <abbr>API</abbr></h2>

<p class=ss style="float:left;margin:0 1.75em 1.75em 0;width:218px"><img src=i/openclipart.org_johnny_automatic_demon_reading_Stewart_Orr.png alt="demon reading book" width=218 height=231><br><span id=live-history-api></span>

<p>The <a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/history.html><abbr>HTML5</abbr> history <abbr>API</abbr></a> is a standardized way to manipulate the browser history via script. Part of this <abbr>API</abbr> &mdash; navigating the history &mdash; has been available in previous versions of <abbr>HTML</abbr>. The new part in <abbr>HTML5</abbr> is a way to add entries to the browser history, and respond when those entries are removed from the stack by the user pressing the browser&#8217;s back button. This means that the <abbr>URL</abbr> can continue to do its job as a unique identifier for the current resource, even in script-heavy applications that don&#8217;t ever perform a full page refresh.

<p>Checking for <abbr>HTML5</abbr> history <abbr>API</abbr> support uses <a href=#techniques>detection technique #1</a>. If your browser supports the <abbr>HTML5</abbr> history <abbr>API</abbr>, there will be a <code>pushState()</code> function on the global <code>history</code> object. If your browser doesn&#8217;t support the history <abbr>API</abbr>, the <code>pushState()</code> function will be undefined.

<pre><code>function supports_history_api() {
  return !!(window.history && history.pushState);
}</code></pre>

<p>Instead of writing this function yourself, you can use <a href=#modernizr>Modernizr</a> (1.6 or later) to detect support for the <abbr>HTML5</abbr> history <abbr>API</abbr>.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> check for history <abbr>API</abbr> support
<pre><code>if (<mark>Modernizr.history</mark>) {
  // history management works!
} else {
  // no history support :(
  // fall back to a scripted solution like <a href=https://github.com/balupton/History.js/>History.js</a>
}</code></pre>

<p class=a>&#x2767;

<h2 id=further-reading>Další čtení</h2>

<p>Specifikace a stnadardy:

<ul>
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html>the <code>&lt;canvas></code> element</a>
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/video.html#video>the <code>&lt;video></code> element</a>
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#states-of-the-type-attribute><code>&lt;input></code> types</a>
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/common-input-element-attributes.html#the-placeholder-attribute>the <code>&lt;input placeholder></code> attribute</a>
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#autofocusing-a-form-control>the <code>&lt;input autofocus></code> attribute</a>
<li><a href=http://dev.w3.org/html5/webstorage/><abbr>HTML5</abbr> storage</a>
<li><a href=http://www.whatwg.org/specs/web-workers/current-work/>Web Workers</a>
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html#offline>Offline web applications</a>
<li><a href=http://www.w3.org/TR/geolocation-API/>Geolocation <abbr>API</abbr></a>
<li><a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/history.html>Session history and navigation</a>
</ul>

<p>Javascriptové knihovny:

<ul>
<li><a href=http://www.modernizr.com/>Modernizr</a>, an <abbr>HTML5</abbr> detection library
<li><a href=http://code.google.com/p/geo-location-javascript/>geo.js</a>, a geolocation <abbr>API</abbr> wrapper
<li><a href=https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-browser-Polyfills><abbr>HTML5</abbr> Cross-browser Polyfills</a>
</ul>

<p>Dalšá články a návody:

<ul>
<li><a href=http://camendesign.com/code/video_for_everybody>Video for Everybody!</a>
<li><a href=http://diveintomark.org/tag/give>A gentle introduction to video encoding</a>
<li><a href=http://wiki.whatwg.org/wiki/Video_type_parameters>Video type parameters</a>
<li><a href=everything.html>The All-In-One Almost-Alphabetical No-Bullshit Guide to Detecting Everything</a>
<li><a href=http://msdn.microsoft.com/en-us/ie/ff468705.aspx>Internet Explorer 9 Guide for Developers</a>
</ul>

<p class=a>&#x2767;

<p>Dočetli jste &#8222;Detekujeme podporu <abbr>HTML5</abbr>.&#8221; Pro další čtení přejděte na <a href=table-of-contents.html>celý obsah knihy</a>.

<div class=pf>
<h4>Did You Know?</h4>
<div class=moneybags>
<blockquote><p>In association with Google Press, O&#8217;Reilly is distributing this book in a variety of formats, including paper, ePub, Mobi, and <abbr>DRM</abbr>-free <abbr>PDF</abbr>. The paid edition is called &#8220;HTML5: Up &amp; Running,&#8221; and it is available now. This chapter is included in the paid edition.
<p>If you liked this chapter and want to show your appreciation, you can <a href="http://www.amazon.com/HTML5-Up-Running-Mark-Pilgrim/dp/0596806027?ie=UTF8&amp;tag=diveintomark-20&amp;creativeASIN=0596806027">buy &#8220;HTML5: Up &amp; Running&#8221; with this affiliate link</a> or <a href=http://oreilly.com/catalog/9780596806033>buy an electronic edition directly from O&#8217;Reilly</a>. You&#8217;ll get a book, and I&#8217;ll get a buck. I do not currently accept direct donations.
</blockquote>
</div>
</div>

<p class=c>Copyright MMIX&ndash;MMXI <a href=about.html>Mark Pilgrim</a>

<form action=http://www.google.com/cse><div><input type=hidden name=cx value=014021643941856155761:6jgee_nxreo><input type=hidden name=ie value=UTF-8><input type=search name=q size=25 placeholder="powered by Google&trade;">&nbsp;<input type=submit name=sa value=Search></div></form>
<script src=j/jquery.js></script>
<script src=j/modernizr.js></script>
<script src=j/gears_init.js></script>
<script src=j/geo.js></script>
<script src=j/dih5.js></script>
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;sensor=false&amp;key=ABQIAAAA9KK0oCozk3pdOlGYD6hrthR5pnyo8QWLgiiZq1vJ3YhZL8oiJBQk9j0jg4PxEDmO36mYgldwXseYGw"></script>
<script>
function supports(bool, suffix) {
  var s = "Your browser ";
  if (bool) {
    s += "supports " + suffix + ".";
  } else {
    s += "does not support " + suffix + ". :(";
  }
  return s;
}
function I_CAN_HAS(result) {
  if (result == "probably") {
    return "can play";
  }
  if (result == "maybe") {
    return "isn't sure if it can play";
  }
  return "can't play";
}
function lookup_location() {
  geo_position_js.getCurrentPosition(show_map, show_map_error);
}
function show_map(loc) {
  $("#geo-wrapper").css({'width':'320px','height':'350px'});
  var map = new GMap2(document.getElementById("geo-wrapper"));
  var center = new GLatLng(loc.coords.latitude,loc.coords.longitude);	
  map.setCenter(center, 14);	
  map.addControl(new GSmallMapControl());
  map.addControl(new GMapTypeControl());
  map.addOverlay(new GMarker(center, {draggable: false, title: "You are here (more or less)"}));
}
function show_map_error() {
  $("#live-geolocation").html('Unable to determine your location.');
}
$(function() {
  $("#live-canvas").html(supports(Modernizr.canvas, "the canvas API"));
  $("#live-canvas-text").html(supports(Modernizr.canvastext, "the canvas text API"));
  $("#live-video").html(supports(Modernizr.video, "HTML5 video"));
  if (Modernizr.video) {
    var ogg = Modernizr.video.ogg;
    var h264 = Modernizr.video.h264;
    var webm = Modernizr.video.webm;
    var vf = "Your browser ";
    if ((ogg == "probably") && (h264 == "probably")) {
      vf += "can play both Ogg Theora and H.264";
    } else if (((ogg == "") || (ogg == "no")) && (h264 == "probably")) {
      vf += "can play H.264 video, but not Ogg Theora";
    } else if (((h264 == "") || (h264 == "no")) && (ogg == "probably")) {
      vf += "can play Ogg Theora video, but not H.264";
    } else {
      vf += I_CAN_HAS(ogg) + " Ogg Theora video. Your browser " + I_CAN_HAS(h264) + " H.264";
    }
    vf += " video.";
    if (webm) {
      vf += " Hey, you can play WebM video, too!";
    }
    $("#live-video-formats").html(vf);
  } else {
    $("#live-video-formats").html(supports(Modernizr.video, "any video formats"));
  }
  var localstorage = false;
  try {
    localstorage = Modernizr.localstorage;
  } catch(e) {}
  $("#live-storage").html(supports(localstorage, "HTML5 storage"));
  $("#live-web-workers").html(supports(Modernizr.webworkers, "web workers"));
  $("#live-offline").html(supports(Modernizr.applicationcache, "offline web applications"));
  if (geo_position_js.init()) {
    $("#live-geolocation").html(supports(true, "geolocation") + ' <a href="#" onclick="lookup_location();return false">Click to look up your location</a>.');
  } else {
    $("#live-geolocation").html(supports(false, "geolocation"));
  }
  var supported_input_types = '';
  for (var itype in Modernizr.inputtypes) {
    if (Modernizr.inputtypes[itype]) {
      supported_input_types += '<code>' + itype + '</code>, ';
    }
  }
  if (!!supported_input_types) {
    $("#live-input-types").html('Your browser supports the following HTML5 input types: ' + supported_input_types.replace(/, $/, ''));
  } else {
    $("#live-input-types").html('Your browser does not support any HTML5 input types.');
  }
  $("#live-input-autofocus").html(supports(!!("autofocus" in document.createElement("input")), "form autofocus"));
  $("#live-microdata-api").html(supports(!!document.getItems, "the HTML5 microdata API"));
  $("#live-history-api").html(supports(!!Modernizr.history, "the HTML5 history API"));
});
</script>
